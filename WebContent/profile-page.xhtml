<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:b="http://bootsfaces.net/ui">
<h:head>
	<title>Profile Page</title>
</h:head>
<h:body>
	<h:outputStylesheet library="css" name="style.css" position="last" />
	<b:navBar brand="Waterfall" brandHref="index.xhtml">
		<b:navbarLinks pull="right">
			<h:form rendered="#{loginControllerBean.loggedInUser != null}">
				<h:commandLink action="profile-page"
					value="#{loginControllerBean.loggedInUser.firstName} #{loginControllerBean.loggedInUser.lastName}"
					styleClass="link-profile-page" />
			</h:form>
			<h:form rendered="#{loginControllerBean.loggedInUser != null}">
				<h:commandButton value="Log out"
					action="#{loginControllerBean.logOutUser()}"
					styleClass="submit-btn" />
			</h:form>
			<h:form rendered="#{loginControllerBean.loggedInUser == null}">
				<h:messages></h:messages>

				<div class="login-username">
					<b:inputText placeholder="Username" id="username"
						value="#{loginControllerBean.username}" styleClass="input" />
				</div>

				<div class="login-password">
					<b:inputSecret placeholder="Password" id="password"
						value="#{loginControllerBean.password}" styleClass="input" />
				</div>
				<div class="login-btn-div">
					<h:commandButton action="#{loginControllerBean.loginUser()}"
						value="Login" styleClass="submit-btn" />
				</div>
			</h:form>
			<h:form target="_blank"
				rendered="#{loginControllerBean.loggedInUser == null}">
				<h:commandLink action="reg-new-user" target="_self" value="Register"
					styleClass="link-register-new-user" />
			</h:form>
		</b:navbarLinks>
	</b:navBar>
	<b:container>
		<b:column span="4">
			<h:form>
				<h1>Update user information</h1>
				<h:messages></h:messages>
				<div class="form-first-name">
					<h:outputLabel value="First Name"
						styleClass="label first-name-label" />
					<h:inputText value="#{loginControllerBean.loggedInUser.firstName}"
						required="true" styleClass="input first-name-input" />
				</div>
				<div class="form-last-name">
					<h:outputLabel value="Last Name" styleClass="label last-name-label" />
					<h:inputText value="#{loginControllerBean.loggedInUser.lastName}"
						required="true" styleClass="input last-name-input" />
				</div>

				<h:outputLabel value="Email" styleClass="label" />
				<h:inputText value="#{loginControllerBean.loggedInUser.email}"
					required="true" styleClass="input" />

				<h:outputLabel value="City" styleClass="label" />
				<h:inputText value="#{loginControllerBean.loggedInUser.city}"
					required="true" styleClass="input" />

				<h:outputLabel value="Username" styleClass="label" />
				<h:inputText value="#{loginControllerBean.loggedInUser.username}"
					required="true" styleClass="input" />

				<h:outputLabel value="Password" styleClass="label" />
				<h:inputSecret value="#{loginControllerBean.loggedInUser.password}"
					required="true" styleClass="input" />

				<h:outputLabel for="birthdate" value="Date of birth (DD-MM-YYYY):"
					styleClass="label" />
				<h:inputText id="birthdate"
					value="#{loginControllerBean.loggedInUser.birthdate}"
					required="true" styleClass="input">
					<f:convertDateTime pattern="dd-M-yyyy" />
				</h:inputText>

				<h:outputLabel value="Country" styleClass="label" />
				<h:selectOneMenu value="#{loginControllerBean.loggedInUser.country}"
					styleClass="input">
					<f:selectItems value="#{registrationControllerBean.allCountries}" />
				</h:selectOneMenu>

				<h:outputLabel value="Gender" styleClass="label" />
				<h:selectOneMenu value="#{loginControllerBean.loggedInUser.gender}"
					styleClass="input">
					<f:selectItem itemValue="Male" itemLabel="Male" />
					<f:selectItem itemValue="Female" itemLabel="Female" />
					<f:selectItem itemValue="Other" itemLabel="Other" />
				</h:selectOneMenu>

				<h:commandButton
					action="#{userControllerBean.updateUser(loginControllerBean.loggedInUser)}"
					value="Save changes" styleClass="submit-btn" />
			</h:form>
		</b:column>
		<div class="col-md-4">
			<h:form>
				<h:outputLabel value="Search for your friends if you got any"
					styleClass="label" />
				<h:inputText value="#{userControllerBean.usernameSearch}" />
				<h:commandButton
					action="#{userControllerBean.searchUserByUsername()}"
					value="Search" styleClass="submit-btn" />
			</h:form>

			<h:form>
				#{userControllerBean.userToSearch.firstName}
				<h:commandButton
					action="#{userControllerBean.addUserToFriendlist()}"
					value="Add to friend list" />
			</h:form>
			<h1>My Friends:</h1>
			<ui:repeat var="friend" value="#{userControllerBean.userList}">
				<p>#{friend.firstName} #{friend.lastName}</p>
			</ui:repeat>
		</div>
	</b:container>
</h:body>
</html>