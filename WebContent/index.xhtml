<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui">
<h:head>
	<title>Waterfall Startpage</title>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<link rel="stylesheet"
		href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
</h:head>
<h:body>
	<h:outputStylesheet library="css" name="style.css" position="last" />
	<h:outputScript library="script" name="script.js"></h:outputScript>
	
	<b:navBar brand="Waterfall">
		<b:navbarLinks pull="right">
			<div class="container-fluid">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<p>#{loginControllerBean.loggedInUser.firstName}</p> <h:form
							rendered="#{loginControllerBean.loggedInUser != null}">
							<h:commandLink action="profile-page" value="Profile page"
								styleClass="link-profile-page" />
						</h:form> <h:form rendered="#{loginControllerBean.loggedInUser != null}">
							<h:commandButton value="Log out"
								action="#{loginControllerBean.logOutUser()}"
								styleClass="submit-btn" />
						</h:form> <h:form rendered="#{loginControllerBean.loggedInUser == null}">
							<h:messages></h:messages>

							<div class="login-username">
								<b:inputText placeholder="Username" id="username"
									value="#{loginControllerBean.username}" styleClass="input" />
							</div>

							<div class="login-password">
								<b:inputSecret placeholder="Password" id="password"
									value="#{loginControllerBean.password}" styleClass="input" />
							</div>
							<div class="login-btn-div">
								<h:commandButton action="#{loginControllerBean.loginUser()}"
									value="Login" styleClass="submit-btn" />
							</div>

						</h:form> <h:form target="_blank"
							rendered="#{loginControllerBean.loggedInUser == null}">
							<h:commandLink action="reg-new-user" target="_self"
								value="Register" styleClass="link-register-new-user" />
						</h:form>
					</li>
				</ul>
			</div>
		</b:navbarLinks>
	</b:navBar>

	<b:container>
		<div class="filter-div">
			<h:form id="filter-form">
				<b:row>
					<b:column span="11">
						<b:inputText value="#{filterControllerBean.tagList}" tags="true"
							render-label="true" placeholder="Filter..."
							styleClass="filter-input" class="search-field" />
					</b:column>
					<b:column span="1">
						<h:commandButton value="Filter"
							action="#{filterControllerBean.filter()}" styleClass="filter-btn" />
					</b:column>
				</b:row>
				<b:row>
					<b:column span="2" offset="8">
						<h:commandLink class="clear-button" value="Restore filters"
							action="#{dropControllerBean.init()}" />
					</b:column>
					<b:column span="2">
						<b:button class="more-filters-link" value="More filters"
							look="link" />
					</b:column>
				</b:row>

				<b:row>
					<b:column span="1" class="show-more-filters">
						<b:selectBooleanCheckbox caption="Male"
							value="#{filterControllerBean.filteredByMale}"
							styleClass="checkbox" />
					</b:column>
					<b:column span="1" class="show-more-filters">
						<b:selectBooleanCheckbox caption="Female"
							value="#{filterControllerBean.filteredByFemale}"
							styleClass="checkbox" />
					</b:column>
					<b:column span="1" class="show-more-filters">
						<b:selectBooleanCheckbox caption="Other"
							value="#{filterControllerBean.filteredByOther}"
							styleClass="checkbox" />
					</b:column>

				</b:row>
				<b:row>
					<b:column class="show-more-filters" span="2">
						<b:inputText styleClass="input" placeholder="First name"
							value="#{filterControllerBean.filterFirstName}" />
					</b:column>
					<b:column class="show-more-filters" span="2">
						<b:inputText styleClass="input" placeholder="Last name"
							value="#{filterControllerBean.filterLastName}" />
					</b:column>
					<b:column class="show-more-filters" span="2">
						<b:inputText styleClass="input" placeholder="Username"
							value="#{filterControllerBean.filterUsername}" />
					</b:column>
					<b:column class="show-more-filters" span="2">
						<b:inputText styleClass="input" placeholder="City"
							value="#{filterControllerBean.filterCity}" />
					</b:column>
					<b:column class="show-more-filters" span="2">
						<b:inputText styleClass="input" placeholder="Country"
							value="#{filterControllerBean.filterCountry}" />
					</b:column>
					<b:column class="show-more-filters" span="6">
						<p id="age-tag">
							<label for="ageSpan">Age span: </label>
							<h:inputText styleClass="input" id="ageSpan"
								value="#{filterControllerBean.ageSpan}" />
						</p>
						<div id="slider-range"></div>
					</b:column>
				</b:row>

			</h:form>
			<h:commandButton
				rendered="#{loginControllerBean.loggedInUser != null}"
				class="show-create-drop-div-btn" value="Write something" />

		</div>
		<div class="create-drop-div">
			<h:form>
				<h:inputTextarea rows="5" styleClass="input"
					value="#{dropControllerBean.content}">
				</h:inputTextarea>
				<h:commandButton styleClass="submit-btn" value="Drop it!"
					action="#{dropControllerBean.createNewDrop()}" />
			</h:form>
		</div>
		<div class="waterfall-div">
			<c:forEach var="drop" items="#{dropControllerBean.dropList}">
				<div class="test">
					<p class="waterfall-username">#{drop.owner.username}</p>
					<p>#{drop.owner.gender}</p>
					<p class="waterfall-creation-date">#{drop.getCreationDateFormatted()}</p>
					<p class="waterfall-drop-content">#{drop.content}</p>
					<p class="comment-here-description">
						<img class="arrow-down" src="resources/img/arrow-down.png" />
					</p>
					<div class="create-comment-div">
						<h:form rendered="#{loginControllerBean.loggedInUser != null}">
							<b:inputText placeholder="Comment..."
								value="#{dropControllerBean.commentContent}" />
							<h:commandButton styleClass="comment-btn" value="Comment"
								action="#{dropControllerBean.createNewComment(drop.getDropId())}" />
						</h:form>
						<div class="test-comment">
							<c:forEach var="comment" items="#{drop.getComments()}">
								<p class="waterfall-username">#{comment.owner.username}</p>
								<p>#{comment.owner.gender}</p>
								<p>wrote at #{comment.getCreationDateFormatted()}</p>

								<p class="waterfall-drop-content">#{comment.content}</p>

							</c:forEach>
						</div>
					</div>
					<h6>#{drop.getComments().size()} comments</h6>


				</div>
			</c:forEach>

		</div>
	</b:container>
</h:body>
</html>