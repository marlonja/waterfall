<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui">

<h:head>
	<!-- BOOTSTRAP -->
	<link rel="stylesheet"
		href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script
		src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type='text/javascript'
		src="https://cdn.rawgit.com/jamesallardice/Placeholders.js/master/dist/placeholders.min.js"></script>
	<script type='text/javascript' src="resources/script/script.js"></script>
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="resources/css/style.css" />

	<title>Waterfall Startpage</title>
</h:head>
<h:body>

	<b:navBar brand="Waterfall">
		<b:navbarLinks pull="right">
			<div class="container-fluid">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<p>#{loginControllerBean.loggedInUser.firstName}</p> <h:form
							rendered="#{loginControllerBean.loggedInUser != null}">
							<h:commandLink action="profile-page" value="Profile page"
								styleClass="link-profile-page" />
						</h:form> <h:form rendered="#{loginControllerBean.loggedInUser != null}">
							<h:commandButton value="Log out"
								action="#{loginControllerBean.logOutUser()}"
								styleClass="submit-btn" />
						</h:form> <h:form rendered="#{loginControllerBean.loggedInUser == null}">
							<h:messages></h:messages>

							<div class="login-username">
								<b:inputText placeholder="Username" id="username"
									value="#{loginControllerBean.username}" required="true"
									styleClass="input" />
							</div>

							<div class="login-password">
								<b:inputSecret placeholder="Password" id="password"
									value="#{loginControllerBean.password}" required="true"
									styleClass="input" />
							</div>
							<div class="login-btn-div">
								<h:commandButton action="#{loginControllerBean.loginUser()}"
									value="Login" styleClass="submit-btn" />
							</div>

						</h:form> <h:form target="_blank"
							rendered="#{loginControllerBean.loggedInUser == null}">
							<h:commandLink action="reg-new-user" target="_self"
								value="Register" styleClass="link-register-new-user" />
						</h:form>
					</li>
				</ul>
			</div>
		</b:navbarLinks>
	</b:navBar>

	<div class="container">
		<div class="filter-div">


			<h:form>
				<b:inputText value="#{filterControllerBean.tagList}" tags="true" render-label="true"
					placeholder="Filter..." styleClass="input" class="search-field" />
				<b:row>
					<b:column span="1">
						<b:selectBooleanCheckbox caption="Male" value="#{filterControllerBean.filteredByMale}"/>
					</b:column>
					<b:column span="1">
						<b:selectBooleanCheckbox caption="Female" value="#{filterControllerBean.filteredByFemale}"/>
					</b:column>
					<b:column span="1">
						<b:selectBooleanCheckbox caption="Other" value="#{filterControllerBean.filteredByOther}"/>
					</b:column>
				</b:row>
				<h:commandButton value="Sort by gender" action="#{filterControllerBean.filterByGender()}"/>
				<h:commandButton value="Search"
					action="#{filterControllerBean.getTagList()}" />
				<h:commandButton class="clear-button" value="Clear"
					action="#{dropControllerBean.init()}"/>

			</h:form>

			<h:commandButton
				rendered="#{loginControllerBean.loggedInUser != null}"
				class="show-create-drop-div-btn" value="Write something" />


		</div>
		<div class="create-drop-div">
			<h:form>
				<h:inputTextarea rows="5" styleClass="input"
					value="#{dropControllerBean.content}">
				</h:inputTextarea>
				<h:commandButton styleClass="submit-btn" value="Drop it!"
					action="#{dropControllerBean.createNewDrop()}" />
			</h:form>
		</div>
		<div class="waterfall-div">
			<c:forEach var="drop" items="#{dropControllerBean.dropList}">
				<div class="test">
					<p class="waterfall-username">#{drop.owner.username}</p>
					<p>#{drop.owner.gender}</p>
					<p class="waterfall-creation-date">#{drop.getCreationDateFormatted()}</p>
					<p class="waterfall-drop-content">#{drop.content}</p>
					<p class="comment-here-description">
						<img class="arrow-down" src="resources/img/arrow-down.png" />
					</p>
					<div class="create-comment-div">
						<h:form rendered="#{loginControllerBean.loggedInUser != null}">
							<b:inputText placeholder="Comment..."
								value="#{dropControllerBean.commentContent}" />
							<h:commandButton styleClass="submit-btn" value="Comment"
								action="#{dropControllerBean.createNewComment(drop.getDropId())}" />
						</h:form>
					</div>
					<h6>Number of comments: #{drop.getComments().size()}</h6>

					<c:forEach var="comment" items="#{drop.getComments()}">
						<p>#{comment.content}</p>

					</c:forEach>
				</div>
			</c:forEach>

		</div>
	</div>
</h:body>
</html>